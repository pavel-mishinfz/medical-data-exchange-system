# API сервиса медицинских карт

| Ресурс                                       | Метод  | Что делает                                            | Доступ         |
|----------------------------------------------|--------|-------------------------------------------------------|----------------|
| /records                                     | POST   | Добавляет запись пациента на прием в базу             | Пациент        |
| /records                                     | GET    | Возвращает все записи                                 | Администратор  |
| /records/user/{user_id}                      | GET    | Возвращает список записей пользователя                | Врач, Пациент  |
| /records/{record_id}                         | DELETE | Удаляет запись на прием из базы                       | Администратор  |
| /schedules                                   | POST   | Создает график работы врача                           | Администратор  |
| /schedules/doctor{doctor_id}                 | GET    | Возвращает график работы                              | Администратор  |
| /schedules/doctor{doctor_id}/available_dates | GET    | Возвращает доступные даты и время для записи на прием | Пациент        |
| /schedules/{schedule_id}                     | PATCH  | Обновляет график работы                               | Администратор  |
| /schedules/{schedule_id}                     | DELETE | Удаляет график работы из базы                         | Администратор  |

# Зависимости

Перед запуском сервиса необходимо установить зависимости из файла requirements.txt

# Запуск

```bash
uvicorn app:app --port 5000 --reload
```

# Запуск с использование файла конфигурации .env

Для запуска из файла конфигурации нужно поместить файл .env в корень сервиса

# Запуск с переопределением переменных окружения

```bash
uvicorn app:app --port 5000 --reload
```

или

```bash
export POSTGRES_DSN_ASYNC=postgresql+asyncpg://postgres:postgres@localhost:5432/postgres 
uvicorn app:app --reload
```

# Конфигурация
| Переменная          | Назначение                                                         | Значение по-умолчанию                                |
|---------------------|--------------------------------------------------------------------|------------------------------------------------------|
| POSTGRES_DSN_ASYNC  | Строка подключения к PostgreSQL                                    | postgresql+asyncpg://user:pass@localhost:5432/foobar |

# Документация

После запуска доступна документация: http://127.0.0.1:5000/docs

# Сборка образа
```bash
docker build -t medical-system/record-service:0.0.1 .
```

или 

```bash
./build_image.sh
```